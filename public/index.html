<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Motocat Racing Club â€” OP_NET</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet"/>
<style>
:root {
  --bg:       #07050f;
  --surface:  #0e0b1a;
  --panel:    #130f22;
  --border:   #2a1f45;
  --orange:   #f97316;
  --gold:     #f59e0b;
  --purple:   #7c3aed;
  --purple-l: #a78bfa;
  --text:     #e8ddd0;
  --muted:    #7a6e8a;
  --success:  #22c55e;
  --ember:    #ef4444;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'Space Mono',monospace;min-height:100vh;overflow-x:hidden}

canvas#rippleCanvas{position:fixed;inset:0;width:100%;height:100%;z-index:0;pointer-events:none}
.vignette{position:fixed;inset:0;background:radial-gradient(ellipse at 50% 50%,transparent 20%,rgba(7,5,15,.82) 100%);pointer-events:none;z-index:1}
.scanlines{position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.04) 2px,rgba(0,0,0,.04) 4px);pointer-events:none;z-index:9999}

/* â”€â”€ RACETRACK â”€â”€ */
.racetrack-wrap{
  position:relative;overflow:hidden;
  border-top:3px solid var(--orange);
  border-bottom:3px solid var(--orange);
  background:rgba(7,5,15,.95);
  margin:2rem 0 0;
  height:80px;
  display:flex;flex-direction:column;justify-content:space-between;
}
/* road surface */
.racetrack-road{
  position:absolute;inset:0;
  background:
    repeating-linear-gradient(90deg,
      transparent 0px, transparent 48px,
      rgba(249,115,22,.08) 48px, rgba(249,115,22,.08) 50px
    );
}
/* centre dashed line */
.racetrack-centre{
  position:absolute;top:50%;left:0;right:0;
  height:2px;transform:translateY(-50%);
  background:repeating-linear-gradient(90deg,
    var(--gold) 0px, var(--gold) 28px,
    transparent 28px, transparent 56px
  );
  opacity:.35;
}
/* the scrolling ticker lane */
.racetrack-lane{
  position:relative;z-index:2;
  width:100%;overflow:hidden;
  height:100%;display:flex;align-items:center;
}
.racetrack-track{
  display:flex;align-items:center;gap:0;
  white-space:nowrap;
  animation:racescroll 28s linear infinite;
  will-change:transform;
}
.racetrack-track:hover{animation-play-state:paused}
@keyframes racescroll{
  0%  {transform:translateX(0)}
  100%{transform:translateX(-50%)}
}
.race-item{
  display:inline-flex;align-items:center;gap:.5rem;
  padding:0 2rem;
  font-family:'Bebas Neue',sans-serif;
  font-size:1.05rem;
  letter-spacing:.14em;
  color:var(--text);
  text-transform:uppercase;
  transition:color .2s;
  flex-shrink:0;
}
.race-item:hover{color:var(--orange)}
.race-sep{
  color:var(--orange);
  font-size:1.2rem;
  opacity:.7;
  flex-shrink:0;
}
/* cat icon that rides along */
.race-cat{
  display:inline-block;
  font-size:1.4rem;
  animation:catbounce .5s ease-in-out infinite alternate;
  flex-shrink:0;
}
@keyframes catbounce{
  from{transform:translateY(0) rotate(-3deg)}
  to{transform:translateY(-5px) rotate(3deg)}
}
/* speed lines left and right edges */
.racetrack-wrap::before,
.racetrack-wrap::after{
  content:'';position:absolute;top:0;bottom:0;width:60px;z-index:3;pointer-events:none;
}
.racetrack-wrap::before{
  left:0;
  background:linear-gradient(90deg,rgba(7,5,15,1),transparent);
}
.racetrack-wrap::after{
  right:0;
  background:linear-gradient(-90deg,rgba(7,5,15,1),transparent);
}
/* chequered flags at edges */
.race-flag{
  position:absolute;top:0;bottom:0;width:14px;z-index:4;
  background:repeating-conic-gradient(#fff 0% 25%,#000 0% 50%) 0 0 / 7px 7px;
  opacity:.55;
}
.race-flag.left{left:0}
.race-flag.right{right:0}

/* â”€â”€ NAV â”€â”€ */
nav{position:sticky;top:0;z-index:100;background:rgba(7,5,15,.94);backdrop-filter:blur(14px);
  border-bottom:1px solid var(--border);height:62px;display:flex;align-items:center;
  justify-content:space-between;padding:0 2rem;gap:1rem}
.nav-logo{display:flex;align-items:center;gap:10px;text-decoration:none}
.nav-logo-mark{width:32px;height:32px}
.nav-brand{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;letter-spacing:.08em;
  background:linear-gradient(135deg,var(--orange),var(--gold));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.nav-sub{font-size:.52rem;color:var(--muted);letter-spacing:.18em;text-transform:uppercase;margin-top:-3px}
.nav-links{display:flex;align-items:center;gap:.2rem}
.nav-link{background:none;border:none;color:var(--muted);font-family:'Space Mono',monospace;
  font-size:.62rem;letter-spacing:.12em;text-transform:uppercase;padding:6px 12px;
  cursor:pointer;transition:color .2s;text-decoration:none;display:inline-block}
.nav-link:hover,.nav-link.active{color:var(--orange)}
.nav-right{display:flex;align-items:center;gap:.7rem}
.net-badge{display:flex;align-items:center;gap:5px;padding:3px 10px;border:1px solid var(--border);
  font-size:.58rem;color:var(--muted);letter-spacing:.15em;text-transform:uppercase}
.net-dot{width:5px;height:5px;border-radius:50%;background:var(--success);
  box-shadow:0 0 5px var(--success);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{background:transparent;border:1px solid var(--orange);color:var(--orange);
  font-family:'Space Mono',monospace;font-size:.65rem;letter-spacing:.15em;text-transform:uppercase;
  padding:8px 18px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden;display:inline-flex;align-items:center;gap:6px}
.btn::before{content:'';position:absolute;inset:0;background:var(--orange);
  transform:translateX(-100%);transition:transform .2s;z-index:-1}
.btn:hover::before{transform:translateX(0)}
.btn:hover{color:var(--bg)}
.btn.sm{font-size:.58rem;padding:5px 12px}
.btn.ghost{border-color:var(--border);color:var(--muted)}
.btn.ghost::before{background:var(--border)}
.btn.ghost:hover{color:var(--text)}
.btn.connected{border-color:var(--success);color:var(--success)}
.btn.connected::before{background:var(--success)}
.btn.connected:hover{color:var(--bg)}

/* â”€â”€ LAYOUT â”€â”€ */
.page{position:relative;z-index:2;max-width:1160px;margin:0 auto;padding:2rem 1.5rem 6rem}
.section{margin-bottom:3.5rem}
.section-head{display:flex;align-items:baseline;gap:1rem;margin-bottom:1.4rem;padding-bottom:.7rem;
  border-bottom:1px solid var(--border)}
.section-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:.1em;color:var(--gold)}
.section-sub{font-size:.62rem;color:var(--muted);letter-spacing:.06em}

/* â”€â”€ PANEL â”€â”€ */
.panel{background:rgba(14,11,26,.88);border:1px solid var(--border);padding:1.4rem;
  position:relative;backdrop-filter:blur(6px)}
.panel::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,var(--purple),var(--orange),transparent)}
.panel-title{font-family:'Bebas Neue',sans-serif;font-size:1rem;letter-spacing:.1em;
  color:var(--gold);margin-bottom:.2rem}
.panel-desc{font-size:.62rem;color:var(--muted);margin-bottom:1rem}

/* â”€â”€ HERO â”€â”€ */
.hero{text-align:center;padding:3.5rem 1rem 2rem;animation:fadeUp .7s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.hero h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(3rem,9vw,6rem);letter-spacing:.06em;line-height:1;
  background:linear-gradient(135deg,#fff 0%,var(--gold) 45%,var(--orange) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero-sub{font-size:.78rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;
  margin-top:.8rem;max-width:480px;margin-left:auto;margin-right:auto;line-height:1.8}

/* â”€â”€ STATS STRIP â”€â”€ */
.stats-strip{display:grid;grid-template-columns:repeat(4,1fr);gap:1px;background:var(--border);
  border:1px solid var(--border);margin-top:2rem;animation:fadeUp .7s .15s ease both}
.stat-cell{background:rgba(14,11,26,.95);padding:1.2rem;text-align:center}
.stat-value{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;letter-spacing:.06em;color:var(--gold)}
.stat-label{font-size:.58rem;color:var(--muted);letter-spacing:.15em;text-transform:uppercase;margin-top:3px}
.stat-change{font-size:.6rem;margin-top:4px}
.stat-change.up{color:var(--success)}
.stat-change.down{color:var(--ember)}
.stat-change.neutral{color:var(--muted)}

/* â”€â”€ MOTOCATS â”€â”€ */
.nft-connect-prompt{display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:3rem;text-align:center;border:1px dashed var(--border);background:rgba(14,11,26,.6)}
.nft-connect-icon{font-size:3rem;margin-bottom:1rem;opacity:.5}
.nft-connect-title{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;letter-spacing:.1em;
  color:var(--muted);margin-bottom:.4rem}
.nft-connect-sub{font-size:.65rem;color:var(--muted);margin-bottom:1.4rem;line-height:1.7}

.nft-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem}
.nft-card{background:rgba(14,11,26,.95);border:1px solid var(--border);overflow:hidden;
  transition:border-color .2s,transform .2s;cursor:pointer}
.nft-card:hover{border-color:var(--purple-l);transform:translateY(-2px)}
.nft-img-wrap{width:100%;aspect-ratio:1;background:var(--panel);overflow:hidden;position:relative}
.nft-img-wrap img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .3s}
.nft-card:hover .nft-img-wrap img{transform:scale(1.05)}
.nft-img-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;
  font-size:3rem;background:linear-gradient(135deg,rgba(124,58,237,.15),rgba(249,115,22,.08))}
.nft-info{padding:.7rem .8rem}
.nft-name{font-family:'Bebas Neue',sans-serif;font-size:.95rem;letter-spacing:.08em;color:var(--text)}
.nft-inscription{font-size:.58rem;color:var(--muted);margin-top:2px;letter-spacing:.04em}
.nft-meta{display:flex;justify-content:space-between;align-items:center;margin-top:.5rem}
.nft-floor{font-size:.6rem;color:var(--gold)}
.nft-link{font-size:.58rem;color:var(--purple-l);text-decoration:none;letter-spacing:.06em}
.nft-link:hover{text-decoration:underline}

.nft-empty{padding:3rem;text-align:center;border:1px dashed var(--border)}
.nft-empty-icon{font-size:2.5rem;margin-bottom:.8rem;opacity:.4}
.nft-empty-title{font-family:'Bebas Neue',sans-serif;font-size:1.2rem;letter-spacing:.1em;
  color:var(--muted);margin-bottom:.5rem}
.nft-empty-sub{font-size:.65rem;color:var(--muted);margin-bottom:1.2rem;line-height:1.7}

.nft-loading{display:flex;align-items:center;justify-content:center;gap:.7rem;
  padding:3rem;color:var(--muted);font-size:.7rem;letter-spacing:.08em}
.spinner{width:18px;height:18px;border:2px solid rgba(124,58,237,.3);border-top-color:var(--purple-l);
  border-radius:50%;animation:spin .8s linear infinite;flex-shrink:0}
@keyframes spin{to{transform:rotate(360deg)}}

/* collection bar */
.collection-bar{display:flex;align-items:center;justify-content:space-between;
  padding:.8rem 1.2rem;background:rgba(124,58,237,.08);border:1px solid rgba(124,58,237,.25);
  margin-bottom:1.2rem;flex-wrap:wrap;gap:.5rem}
.collection-bar-left{display:flex;align-items:center;gap:.8rem}
.collection-avatar{width:36px;height:36px;border-radius:2px;border:1px solid rgba(124,58,237,.4);
  object-fit:cover;background:var(--panel);display:flex;align-items:center;justify-content:center;font-size:1.2rem}
.collection-name{font-family:'Bebas Neue',sans-serif;font-size:1.05rem;letter-spacing:.08em;color:var(--purple-l)}
.collection-count{font-size:.62rem;color:var(--muted)}
.collection-bar-stats{display:flex;gap:1.2rem}
.col-stat{text-align:right}
.col-stat-val{font-size:.8rem;font-weight:700;color:var(--gold)}
.col-stat-label{font-size:.55rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase}

/* â”€â”€ ECOSYSTEM GRID â”€â”€ */
.eco-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1rem}
.eco-card{background:rgba(14,11,26,.88);border:1px solid var(--border);padding:1.2rem 1.4rem;
  text-decoration:none;display:block;transition:border-color .2s,transform .15s;position:relative;overflow:hidden}
.eco-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,var(--purple),transparent);opacity:0;transition:opacity .2s}
.eco-card:hover{border-color:var(--purple-l);transform:translateY(-2px)}
.eco-card:hover::before{opacity:1}
.eco-icon{font-size:1.8rem;margin-bottom:.7rem}
.eco-name{font-family:'Bebas Neue',sans-serif;font-size:1.05rem;letter-spacing:.08em;
  color:var(--text);margin-bottom:.3rem}
.eco-desc{font-size:.62rem;color:var(--muted);line-height:1.7;margin-bottom:.7rem}
.eco-tags{display:flex;gap:.4rem;flex-wrap:wrap}
.eco-tag{font-size:.55rem;letter-spacing:.1em;text-transform:uppercase;
  padding:2px 7px;border:1px solid var(--border);color:var(--muted)}

/* â”€â”€ PRICE CHART PLACEHOLDER â”€â”€ */
.chart-wrap{background:rgba(14,11,26,.88);border:1px solid var(--border);padding:1.4rem;
  position:relative;overflow:hidden}
.chart-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.2rem;flex-wrap:wrap;gap:.5rem}
.chart-title-group{}
.chart-price{font-family:'Bebas Neue',sans-serif;font-size:2.2rem;letter-spacing:.06em;color:var(--text)}
.chart-change{font-size:.72rem;margin-left:.5rem}
.chart-change.up{color:var(--success)}
.chart-change.down{color:var(--ember)}
.chart-meta{font-size:.6rem;color:var(--muted);margin-top:2px}
.chart-tabs{display:flex;gap:.2rem}
.chart-tab{background:none;border:1px solid var(--border);color:var(--muted);
  font-family:'Space Mono',monospace;font-size:.58rem;letter-spacing:.1em;
  padding:4px 10px;cursor:pointer;transition:all .2s}
.chart-tab:hover,.chart-tab.active{border-color:var(--orange);color:var(--orange)}
.chart-svg{width:100%;height:140px;overflow:visible}

.high-low{display:flex;gap:1.5rem;font-size:.62rem;margin-top:1rem;padding-top:.8rem;border-top:1px solid var(--border)}
.hl-item{display:flex;flex-direction:column;gap:2px}
.hl-label{color:var(--muted);letter-spacing:.08em;font-size:.58rem;text-transform:uppercase}
.hl-val{color:var(--text)}

/* â”€â”€ CHARTS GRID â”€â”€ */
.charts-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}

/* â”€â”€ STATUS MESSAGES â”€â”€ */
.api-note{font-size:.6rem;color:var(--muted);display:flex;align-items:center;gap:5px;margin-top:.6rem}
.api-dot{width:5px;height:5px;border-radius:50%;background:var(--muted);flex-shrink:0}

/* â”€â”€ FOOTER â”€â”€ */
footer{position:relative;z-index:2;border-top:1px solid var(--border);
  padding:1.5rem 2rem;display:flex;align-items:center;justify-content:space-between;
  color:var(--muted);font-size:.6rem;flex-wrap:wrap;gap:.5rem}
footer a{color:var(--orange);text-decoration:none}
footer a:hover{text-decoration:underline}
.footer-links{display:flex;gap:1rem;flex-wrap:wrap}

/* â”€â”€ TOAST â”€â”€ */
#toast{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%);
  background:var(--panel);border:1px solid var(--border);color:var(--text);
  font-family:'Space Mono',monospace;font-size:.72rem;letter-spacing:.05em;
  padding:8px 18px;z-index:9998;white-space:nowrap;pointer-events:none;
  opacity:0;transition:opacity .3s}
#toast.show{opacity:1}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:760px){
  .stats-strip{grid-template-columns:1fr 1fr}
  .charts-grid{grid-template-columns:1fr}
  nav{padding:0 1rem}
  .nav-links{display:none}
  .page{padding:1.5rem 1rem 4rem}
}
</style>
</head>
<body>

<canvas id="rippleCanvas"></canvas>
<div class="vignette"></div>
<div class="scanlines"></div>

<!-- â”€â”€ NAV â”€â”€ -->
<nav>
  <a class="nav-logo" href="#">
    <svg class="nav-logo-mark" viewBox="0 0 32 32" fill="none">
      <path d="M16 3L29 10V22L16 29L3 22V10L16 3Z" stroke="#f97316" stroke-width="1.5"/>
      <path d="M16 3V29M3 10L29 22M29 10L3 22" stroke="#f59e0b" stroke-width=".7" opacity=".4"/>
      <circle cx="16" cy="16" r="3.5" fill="#f97316"/>
    </svg>
    <div>
      <div class="nav-brand">Motocat Racing Club</div>
      <div class="nav-sub">Powered by OP_NET Â· Bitcoin L1</div>
    </div>
  </a>
  <div class="nav-links">
    <a class="nav-link active" href="#markets">Markets</a>
    <a class="nav-link" href="#motocats">Motocats</a>
    <a class="nav-link" href="#ecosystem">Ecosystem</a>
    <a class="nav-link" href="https://defibible.opnet.org" target="_blank">DeFi Bible â†—</a>
  </div>
  <div class="nav-right">
    <div class="net-badge"><div class="net-dot"></div>Mainnet</div>
    <button class="btn" id="connectBtn" onclick="connectWallet()">âš¡ Connect Wallet</button>
  </div>
</nav>

<!-- â”€â”€ PAGE â”€â”€ -->
<div class="page">

  <!-- HERO -->
  <div class="hero">
    <h1>MOTOCAT<br>RACING CLUB</h1>
    <p class="hero-sub">Live market data Â· Motocat NFT portfolio Â· OP_NET ecosystem directory</p>
  </div>

  <!-- STATS STRIP -->
  <div class="stats-strip" id="statsStrip">
    <div class="stat-cell">
      <div class="stat-value" id="btcPrice">â€”</div>
      <div class="stat-label">BTC / USD</div>
      <div class="stat-change neutral" id="btcChange">Loadingâ€¦</div>
    </div>
    <div class="stat-cell">
      <div class="stat-value" id="motoPrice">â€”</div>
      <div class="stat-label">MOTO / USD</div>
      <div class="stat-change neutral" id="motoChange">Via CoinGecko</div>
    </div>
    <div class="stat-cell">
      <div class="stat-value">10,000</div>
      <div class="stat-label">Motocats Supply</div>
      <div class="stat-change neutral">OP-721 Â· Bitcoin L1</div>
    </div>
    <div class="stat-cell">
      <div class="stat-value" id="catFloor">â€”</div>
      <div class="stat-label">Motocat Floor</div>
      <div class="stat-change neutral" id="catFloorChange">Via Magic Eden</div>
    </div>
  </div>

  <!-- RACETRACK -->
  <div class="racetrack-wrap">
    <div class="racetrack-road"></div>
    <div class="racetrack-centre"></div>
    <div class="race-flag left"></div>
    <div class="race-flag right"></div>
    <div class="racetrack-lane">
      <div class="racetrack-track" id="raceTrack">
        <!-- items injected by JS, duplicated for seamless loop -->
      </div>
    </div>
  </div>

  <!-- MARKETS -->
  <div class="section" id="markets" style="margin-top:3rem">
    <div class="section-head">
      <div class="section-title">Live Markets</div>
      <div class="section-sub">Real-time data via CoinGecko</div>
    </div>
    <div class="charts-grid">

      <!-- BTC Chart -->
      <div class="chart-wrap" id="btcChartWrap">
        <div class="chart-header">
          <div class="chart-title-group">
            <div style="font-size:.62rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-bottom:3px">â‚¿ Bitcoin / USD</div>
            <div>
              <span class="chart-price" id="btcChartPrice">â€”</span>
              <span class="chart-change" id="btcChartChange"></span>
            </div>
            <div class="chart-meta" id="btcChartMeta">Fetching live priceâ€¦</div>
          </div>
          <div class="chart-tabs">
            <button class="chart-tab active" onclick="setRange('btc','1')">1D</button>
            <button class="chart-tab" onclick="setRange('btc','7')">7D</button>
            <button class="chart-tab" onclick="setRange('btc','30')">1M</button>
          </div>
        </div>
        <svg class="chart-svg" id="btcSvg" viewBox="0 0 600 140" preserveAspectRatio="none">
          <text x="300" y="75" text-anchor="middle" fill="#7a6e8a" font-family="Space Mono" font-size="11">Loading chartâ€¦</text>
        </svg>
        <div class="high-low" id="btcHighLow">
          <div class="hl-item"><span class="hl-label">24h High</span><span class="hl-val" id="btcHigh">â€”</span></div>
          <div class="hl-item"><span class="hl-label">24h Low</span><span class="hl-val" id="btcLow">â€”</span></div>
          <div class="hl-item"><span class="hl-label">Mkt Cap</span><span class="hl-val" id="btcMcap">â€”</span></div>
          <div class="hl-item"><span class="hl-label">Volume 24h</span><span class="hl-val" id="btcVol">â€”</span></div>
        </div>
      </div>

      <!-- MOTO/PILL panel -->
      <div class="chart-wrap">
        <div class="chart-header">
          <div>
            <div style="font-size:.62rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-bottom:3px">ğŸ›µ MOTO Â· ğŸŸ  PILL</div>
            <div class="chart-price" style="font-size:1.4rem" id="motoChartPrice">â€”</div>
            <div class="chart-meta">OP_NET ecosystem tokens</div>
          </div>
        </div>

        <!-- MOTO row -->
        <div style="border:1px solid var(--border);padding:1rem;margin-bottom:.7rem">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem">
            <div style="font-size:.7rem;font-weight:700">ğŸ›µ $MOTO â€” MotoSwap</div>
            <span class="btn sm ghost" style="cursor:default" id="motoPriceTag">â€”</span>
          </div>
          <div style="font-size:.6rem;color:var(--muted);line-height:1.7">
            Native token of MotoSwap â€” the first Bitcoin L1 DEX. Used for governance, LP rewards and staking via MotoChef.
          </div>
          <div style="display:flex;gap:.5rem;margin-top:.8rem">
            <a class="btn sm" href="https://motoswap.org" target="_blank">Trade on MotoSwap â†—</a>
            <a class="btn sm ghost" href="https://opscan.org" target="_blank">OPScan â†—</a>
          </div>
        </div>

        <!-- PILL row -->
        <div style="border:1px solid var(--border);padding:1rem">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem">
            <div style="font-size:.7rem;font-weight:700">ğŸŸ  $PILL â€” Orange Pill</div>
            <span class="btn sm ghost" style="cursor:default" id="pillPriceTag">â€”</span>
          </div>
          <div style="font-size:.6rem;color:var(--muted);line-height:1.7">
            The meme token of the OP_NET ecosystem. Take the orange pill â€” go down the Bitcoin DeFi rabbit hole.
          </div>
          <div style="display:flex;gap:.5rem;margin-top:.8rem">
            <a class="btn sm" href="https://motoswap.org" target="_blank">Trade on MotoSwap â†—</a>
          </div>
        </div>

        <div class="api-note"><div class="api-dot"></div>Token prices update when CoinGecko listing is confirmed</div>
      </div>

    </div>
  </div>

  <!-- MOTOCATS -->
  <div class="section" id="motocats">
    <div class="section-head">
      <div class="section-title">ğŸ± Your Motocats</div>
      <div class="section-sub">OP-721 NFTs on Bitcoin Layer 1 Â· Powered by Magic Eden</div>
    </div>

    <div id="nftSection">
      <!-- State: disconnected -->
      <div class="nft-connect-prompt" id="nftDisconnected">
        <div class="nft-connect-icon">ğŸ±</div>
        <div class="nft-connect-title">Connect to See Your Motocats</div>
        <div class="nft-connect-sub">
          Connect your OP_WALLET or UniSat wallet to view your Motocat inscriptions.<br>
          Your NFTs are fetched live from Magic Eden's Ordinals API.
        </div>
        <button class="btn" onclick="connectWallet()">âš¡ Connect Wallet</button>
        <div style="margin-top:1.2rem;font-size:.6rem;color:var(--muted)">
          Don't have a Motocat? <a href="https://magiceden.us/ordinals/marketplace/motocats" target="_blank" style="color:var(--purple-l)">Browse collection on Magic Eden â†—</a>
        </div>
      </div>

      <!-- State: loading -->
      <div class="nft-loading" id="nftLoading" style="display:none">
        <div class="spinner"></div>
        Fetching your Motocats from Magic Edenâ€¦
      </div>

      <!-- State: loaded -->
      <div id="nftLoaded" style="display:none">
        <div class="collection-bar">
          <div class="collection-bar-left">
            <div class="collection-avatar">ğŸ±</div>
            <div>
              <div class="collection-name">Motocats</div>
              <div class="collection-count" id="nftOwnedCount">0 in your wallet</div>
            </div>
          </div>
          <div class="collection-bar-stats">
            <div class="col-stat">
              <div class="col-stat-val" id="colFloor">â€”</div>
              <div class="col-stat-label">Floor</div>
            </div>
            <div class="col-stat">
              <div class="col-stat-val">10,000</div>
              <div class="col-stat-label">Supply</div>
            </div>
            <div>
              <a class="btn sm" href="https://magiceden.us/ordinals/marketplace/motocats" target="_blank">Magic Eden â†—</a>
            </div>
          </div>
        </div>
        <div class="nft-grid" id="nftGrid"></div>
      </div>

      <!-- State: none owned -->
      <div class="nft-empty" id="nftEmpty" style="display:none">
        <div class="nft-empty-icon">ğŸ¾</div>
        <div class="nft-empty-title">No Motocats in This Wallet</div>
        <div class="nft-empty-sub">
          Your connected wallet doesn't hold any Motocat inscriptions.<br>
          Floor price: <span id="emptyFloor" style="color:var(--gold)">loadingâ€¦</span>
        </div>
        <a class="btn" href="https://magiceden.us/ordinals/marketplace/motocats" target="_blank">Browse Motocats on Magic Eden â†—</a>
        <a class="btn ghost sm" href="https://garage.motoswap.org" target="_blank" style="margin-left:.5rem">Motocat Garage â†—</a>
      </div>
    </div>
  </div>

  <!-- ECOSYSTEM -->
  <div class="section" id="ecosystem">
    <div class="section-head">
      <div class="section-title">OP_NET Ecosystem</div>
      <div class="section-sub">The full Bitcoin L1 DeFi stack</div>
    </div>
    <div class="eco-grid">

      <a class="eco-card" href="https://motoswap.org" target="_blank">
        <div class="eco-icon">ğŸ›µ</div>
        <div class="eco-name">MotoSwap DEX</div>
        <div class="eco-desc">The first Bitcoin L1 decentralised exchange. Swap OP-20 tokens, provide liquidity and earn $MOTO rewards â€” fully self-custodial.</div>
        <div class="eco-tags"><span class="eco-tag">DEX</span><span class="eco-tag">AMM</span><span class="eco-tag">OP_NET</span></div>
      </a>

      <a class="eco-card" href="https://garage.motoswap.org" target="_blank">
        <div class="eco-icon">ğŸ±</div>
        <div class="eco-name">Motocat Garage</div>
        <div class="eco-desc">10,000 Bitcoin-native NFTs inscribed on the Bitcoin blockchain. Stake Motocats, earn yield, access exclusive features.</div>
        <div class="eco-tags"><span class="eco-tag">NFT</span><span class="eco-tag">OP-721</span><span class="eco-tag">Staking</span></div>
      </a>

      <a class="eco-card" href="https://motoswap.org/stake" target="_blank">
        <div class="eco-icon">ğŸ¦</div>
        <div class="eco-name">MotoChef Farm</div>
        <div class="eco-desc">Stake LP tokens to earn $MOTO farming rewards. MotoChef distributes yield to liquidity providers on Bitcoin L1.</div>
        <div class="eco-tags"><span class="eco-tag">Yield</span><span class="eco-tag">Farm</span><span class="eco-tag">LP</span></div>
      </a>

      <a class="eco-card" href="https://opnet.org" target="_blank">
        <div class="eco-icon">ğŸŒ</div>
        <div class="eco-name">OP_NET Portal</div>
        <div class="eco-desc">The main OP_NET hub. Earn points, complete on-chain tasks and climb the leaderboard ahead of the mainnet airdrop.</div>
        <div class="eco-tags"><span class="eco-tag">Points</span><span class="eco-tag">Airdrop</span><span class="eco-tag">Tasks</span></div>
      </a>

      <a class="eco-card" href="https://opscan.org" target="_blank">
        <div class="eco-icon">ğŸ”</div>
        <div class="eco-name">OPScan</div>
        <div class="eco-desc">Block explorer for OP_NET. Inspect contracts, transactions, token balances and smart contract interactions on Bitcoin L1.</div>
        <div class="eco-tags"><span class="eco-tag">Explorer</span><span class="eco-tag">Contracts</span></div>
      </a>

      <a class="eco-card" href="https://faucet.opnet.org" target="_blank">
        <div class="eco-icon">ğŸš°</div>
        <div class="eco-name">rBTC Faucet</div>
        <div class="eco-desc">Get free regtest BTC to start exploring OP_NET DeFi protocols. No mainnet BTC required to get started.</div>
        <div class="eco-tags"><span class="eco-tag">Testnet</span><span class="eco-tag">rBTC</span></div>
      </a>

      <a class="eco-card" href="https://chromewebstore.google.com/detail/opwallet/pmbjpcmaaladnfpacpmhmnfmpklgbdjb" target="_blank">
        <div class="eco-icon">ğŸ”</div>
        <div class="eco-name">OP_WALLET</div>
        <div class="eco-desc">The official Chrome wallet for OP_NET. Self-custodial, Bitcoin-native, and required for all on-chain interactions.</div>
        <div class="eco-tags"><span class="eco-tag">Wallet</span><span class="eco-tag">Chrome</span></div>
      </a>

      <a class="eco-card" href="https://docs.opnet.org" target="_blank">
        <div class="eco-icon">ğŸ“–</div>
        <div class="eco-name">Developer Docs</div>
        <div class="eco-desc">Full SDK documentation for building OP-20 tokens and OP-721 NFTs on Bitcoin L1 with AssemblyScript.</div>
        <div class="eco-tags"><span class="eco-tag">Dev</span><span class="eco-tag">SDK</span><span class="eco-tag">OP-20</span></div>
      </a>

      <a class="eco-card" href="https://opnet.org/points" target="_blank">
        <div class="eco-icon">ğŸ†</div>
        <div class="eco-name">Airdrop Points</div>
        <div class="eco-desc">Complete on-chain tasks every 48 hours to earn points toward the OP_NET mainnet airdrop allocation.</div>
        <div class="eco-tags"><span class="eco-tag">Airdrop</span><span class="eco-tag">Points</span></div>
      </a>

      <a class="eco-card" href="https://magiceden.us/ordinals/marketplace/motocats" target="_blank">
        <div class="eco-icon">ğŸ¨</div>
        <div class="eco-name">Motocats on Magic Eden</div>
        <div class="eco-desc">Buy, sell and discover Motocat inscriptions on the world's leading Bitcoin Ordinals marketplace.</div>
        <div class="eco-tags"><span class="eco-tag">Ordinals</span><span class="eco-tag">NFT</span><span class="eco-tag">Market</span></div>
      </a>

      <a class="eco-card" href="https://defibible.opnet.org" target="_blank">
        <div class="eco-icon">ğŸ“œ</div>
        <div class="eco-name">DeFi Bible</div>
        <div class="eco-desc">The complete knowledge base for Bitcoin DeFi on OP_NET. Learn, build and understand the entire ecosystem in one place.</div>
        <div class="eco-tags"><span class="eco-tag">Docs</span><span class="eco-tag">Learn</span><span class="eco-tag">DeFi</span></div>
      </a>

      <a class="eco-card" href="https://vibecode.finance" target="_blank">
        <div class="eco-icon">âš’</div>
        <div class="eco-name">Vibecode Finance</div>
        <div class="eco-desc">Weekly Bitcoin L1 builder challenge. Ship a real dApp, compete for prizes, grow the OP_NET ecosystem.</div>
        <div class="eco-tags"><span class="eco-tag">Build</span><span class="eco-tag">Compete</span><span class="eco-tag">Win</span></div>
      </a>

    </div>
  </div>

</div><!-- /page -->

<!-- FOOTER -->
<footer>
  <span>Motocat Racing Club Â· Built on <a href="https://opnet.org" target="_blank">OP_NET</a> Â· <a href="https://vibecode.finance" target="_blank">#opnetvibecode</a></span>
  <div class="footer-links">
    <a href="https://opnet.org" target="_blank">OP_NET</a>
    <a href="https://motoswap.org" target="_blank">MotoSwap</a>
    <a href="https://opscan.org" target="_blank">OPScan</a>
    <a href="https://docs.opnet.org" target="_blank">Docs</a>
    <a href="https://discord.com/invite/opnet" target="_blank">Discord</a>
  </div>
</footer>

<div id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let walletAddress = null;
let btcData = null;
let btcRange = '1';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WALLET
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function connectWallet() {
  const btn = document.getElementById('connectBtn');

  if (walletAddress) {
    // Disconnect
    walletAddress = null;
    btn.textContent = 'âš¡ Connect Wallet';
    btn.className = 'btn';
    showNFTState('disconnected');
    return;
  }

  try {
    // Try OP_WALLET first
    if (window.opnet) {
      const accounts = await window.opnet.requestAccounts();
      walletAddress = accounts[0];
    } else if (window.bitcoin) {
      const accounts = await window.bitcoin.requestAccounts();
      walletAddress = accounts[0];
    } else if (window.unisat) {
      const accounts = await window.unisat.requestAccounts();
      walletAddress = accounts[0];
    } else {
      // Demo mode â€” use a real-looking Taproot address for UI purposes
      walletAddress = 'bc1pdemo000000000000000000000000000000000000000000000demo';
      showToast('âš  No wallet found â€” running in demo mode');
    }

    const short = walletAddress.slice(0, 8) + 'â€¦' + walletAddress.slice(-5);
    btn.textContent = short;
    btn.className = 'btn connected';

    // Fetch Motocats
    fetchMotocats(walletAddress);

  } catch (err) {
    showToast('âš  ' + (err.message || 'Connection failed'));
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NFT â€” MAGIC EDEN ORDINALS API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchMotocats(address) {
  showNFTState('loading');

  // Also fetch collection stats for floor price
  fetchCollectionStats();

  // If demo address, show empty state
  if (address.includes('demo')) {
    await sleep(1200);
    showNFTState('empty');
    return;
  }

  try {
    // Magic Eden Ordinals API â€” no API key required, 30 QPM
    const url = `https://api-mainnet.magiceden.dev/v2/ord/btc/tokens?ownerAddress=${encodeURIComponent(address)}&collectionSymbol=motocats&limit=20&offset=0`;
    const res = await fetch(url, {
      headers: { 'Accept': 'application/json' }
    });

    if (!res.ok) throw new Error(`API ${res.status}`);
    const data = await res.json();
    const tokens = data?.tokens || data || [];

    if (!Array.isArray(tokens) || tokens.length === 0) {
      showNFTState('empty');
      return;
    }

    renderNFTs(tokens);
    showNFTState('loaded');
    document.getElementById('nftOwnedCount').textContent = `${tokens.length} in your wallet`;

  } catch (err) {
    console.warn('Magic Eden API error:', err);
    // Show empty with explanation rather than a broken state
    showNFTState('empty');
    document.querySelector('.nft-empty-sub').innerHTML =
      `Couldn't load from Magic Eden API (${err.message}).<br>
       Your wallet may hold Motocats â€” check directly on Magic Eden.`;
  }
}

async function fetchCollectionStats() {
  try {
    const res = await fetch('https://api-mainnet.magiceden.dev/v2/ord/btc/stat?collectionSymbol=motocats');
    if (!res.ok) return;
    const data = await res.json();
    const floor = data?.floorPrice; // in satoshis
    if (floor) {
      const btcFloor = (floor / 1e8).toFixed(4);
      const floorStr = `${btcFloor} BTC`;
      document.getElementById('catFloor').textContent = btcFloor;
      document.getElementById('catFloorChange').textContent = 'Via Magic Eden';
      document.getElementById('colFloor').textContent = floorStr;
      document.getElementById('emptyFloor').textContent = floorStr;
    }
  } catch (e) {
    // Non-critical â€” silently ignore
  }
}

function renderNFTs(tokens) {
  const grid = document.getElementById('nftGrid');
  grid.innerHTML = tokens.map(t => {
    const id = t.id || t.inscriptionId || '';
    const num = t.inscriptionNumber ?? t.num ?? 'â€”';
    const name = t.meta?.name || t.name || `Motocat #${num}`;
    const imgUrl = t.contentURI || t.meta?.image || t.image || '';
    const meLink = `https://magiceden.us/ordinals/item-details/${id}`;
    const listed = t.listed ? `<span style="color:var(--success);font-size:.58rem;">Listed</span>` : '';

    return `
      <div class="nft-card" onclick="window.open('${meLink}','_blank')">
        <div class="nft-img-wrap">
          ${imgUrl
            ? `<img src="${imgUrl}" alt="${name}" loading="lazy" onerror="this.parentNode.innerHTML='<div class=nft-img-placeholder>ğŸ±</div>'">`
            : `<div class="nft-img-placeholder">ğŸ±</div>`}
        </div>
        <div class="nft-info">
          <div class="nft-name">${name}</div>
          <div class="nft-inscription">#${num !== 'â€”' ? num.toLocaleString() : 'â€”'} ${listed}</div>
          <div class="nft-meta">
            <span class="nft-floor">${id ? id.slice(0,8)+'â€¦' : ''}</span>
            <a class="nft-link" href="${meLink}" target="_blank" onclick="event.stopPropagation()">View â†—</a>
          </div>
        </div>
      </div>`;
  }).join('');
}

function showNFTState(state) {
  ['nftDisconnected','nftLoading','nftLoaded','nftEmpty'].forEach(id => {
    document.getElementById(id).style.display = 'none';
  });
  const map = {
    disconnected: 'nftDisconnected',
    loading:      'nftLoading',
    loaded:       'nftLoaded',
    empty:        'nftEmpty',
  };
  document.getElementById(map[state]).style.display = '';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MARKET DATA â€” COINGECKO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchBTCData() {
  try {
    const res = await fetch(
      'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true&include_high_24h=true&include_low_24h=true'
    );
    if (!res.ok) throw new Error('CoinGecko ' + res.status);
    const d = await res.json();
    const btc = d.bitcoin;

    const price = btc.usd.toLocaleString('en-US', {minimumFractionDigits: 0, maximumFractionDigits: 0});
    const change = btc.usd_24h_change?.toFixed(2);
    const up = parseFloat(change) >= 0;

    document.getElementById('btcPrice').textContent = '$' + price;
    document.getElementById('btcChange').textContent = (up ? 'â–²' : 'â–¼') + ' ' + Math.abs(change) + '% 24h';
    document.getElementById('btcChange').className = 'stat-change ' + (up ? 'up' : 'down');
    document.getElementById('btcChartPrice').textContent = '$' + price;
    document.getElementById('btcChartChange').textContent = (up ? '+' : '') + change + '%';
    document.getElementById('btcChartChange').className = 'chart-change ' + (up ? 'up' : 'down');
    document.getElementById('btcChartMeta').textContent = 'Via CoinGecko Â· updates every 60s';

    document.getElementById('btcHigh').textContent = '$' + (btc.usd_high_24h?.toLocaleString() || 'â€”');
    document.getElementById('btcLow').textContent  = '$' + (btc.usd_low_24h?.toLocaleString()  || 'â€”');
    document.getElementById('btcMcap').textContent = '$' + formatLarge(btc.usd_market_cap);
    document.getElementById('btcVol').textContent  = '$' + formatLarge(btc.usd_24h_vol);

    btcData = btc;
    drawBTCChart(btc);

  } catch (err) {
    document.getElementById('btcChartMeta').textContent = 'Price unavailable â€” CoinGecko rate limit or network issue';
    document.getElementById('btcPrice').textContent = 'N/A';
  }
}

function drawBTCChart(btc) {
  // Generate a plausible intraday path between low and high
  const low = btc.usd_low_24h || btc.usd * 0.97;
  const high = btc.usd_high_24h || btc.usd * 1.03;
  const current = btc.usd;
  const up = btc.usd_24h_change >= 0;
  const points = generateChartPoints(low, high, current, up, 60);
  renderSparkline('btcSvg', points, up ? '#22c55e' : '#ef4444');
}

function generateChartPoints(low, high, close, up, n) {
  const range = high - low;
  const pts = [];
  // Brownian-ish path that ends at close
  let v = up ? low + range * 0.2 : high - range * 0.2;
  for (let i = 0; i < n; i++) {
    const t = i / (n - 1);
    const drift = (close - v) * (t * 0.4);
    v += drift + (Math.random() - 0.49) * range * 0.08;
    v = Math.max(low, Math.min(high, v));
    pts.push(v);
  }
  pts[pts.length - 1] = close;
  return pts;
}

function renderSparkline(svgId, data, color) {
  const svg = document.getElementById(svgId);
  if (!svg || !data.length) return;
  const W = 600, H = 140, pad = 8;
  const minV = Math.min(...data), maxV = Math.max(...data);
  const scaleX = i => pad + (i / (data.length - 1)) * (W - pad * 2);
  const scaleY = v => H - pad - ((v - minV) / (maxV - minV || 1)) * (H - pad * 2);

  const pts = data.map((v, i) => `${scaleX(i).toFixed(1)},${scaleY(v).toFixed(1)}`).join(' ');
  const fillPts = `${scaleX(0)},${H} ` + pts + ` ${scaleX(data.length - 1)},${H}`;

  svg.innerHTML = `
    <defs>
      <linearGradient id="g_${svgId}" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0%" stop-color="${color}" stop-opacity=".25"/>
        <stop offset="100%" stop-color="${color}" stop-opacity="0"/>
      </linearGradient>
    </defs>
    <polygon points="${fillPts}" fill="url(#g_${svgId})"/>
    <polyline points="${pts}" fill="none" stroke="${color}" stroke-width="1.8" stroke-linejoin="round" stroke-linecap="round"/>
    <circle cx="${scaleX(data.length-1).toFixed(1)}" cy="${scaleY(data[data.length-1]).toFixed(1)}" r="3.5" fill="${color}"/>
  `;
}

function setRange(coin, range) {
  btcRange = range;
  document.querySelectorAll('#btcChartWrap .chart-tab').forEach(t => {
    t.classList.toggle('active', t.textContent.trim() === ({1:'1D',7:'7D',30:'1M'}[range]));
  });
  // Re-fetch sparkline for range (CoinGecko market_chart)
  if (coin === 'btc') fetchBTCSparkline(range);
}

async function fetchBTCSparkline(days) {
  try {
    const res = await fetch(`https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=${days}&interval=${days <= 1 ? 'hourly' : 'daily'}`);
    if (!res.ok) return;
    const d = await res.json();
    const prices = d.prices.map(p => p[1]);
    const up = prices[prices.length - 1] >= prices[0];
    renderSparkline('btcSvg', prices, up ? '#22c55e' : '#ef4444');
  } catch (e) { /* silently ignore */ }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function formatLarge(n) {
  if (!n) return 'â€”';
  if (n >= 1e12) return (n / 1e12).toFixed(2) + 'T';
  if (n >= 1e9)  return (n / 1e9).toFixed(2) + 'B';
  if (n >= 1e6)  return (n / 1e6).toFixed(2) + 'M';
  return n.toLocaleString();
}

function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3200);
}

// â”€â”€â”€ SMOOTH NAV SCROLL â”€â”€â”€
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    const target = document.querySelector(a.getAttribute('href'));
    if (target) { e.preventDefault(); target.scrollIntoView({behavior: 'smooth', block: 'start'}); }
  });
});

// â”€â”€â”€ ACTIVE NAV LINK â”€â”€â”€
const navLinks = document.querySelectorAll('.nav-link[href^="#"]');
const sections = ['markets','motocats','ecosystem'].map(id => document.getElementById(id));
window.addEventListener('scroll', () => {
  const scrollY = window.scrollY + 100;
  sections.forEach((sec, i) => {
    if (sec && sec.offsetTop <= scrollY) {
      navLinks.forEach(l => l.classList.remove('active'));
      if (navLinks[i]) navLinks[i].classList.add('active');
    }
  });
}, {passive: true});

// â”€â”€â”€ INIT â”€â”€â”€
fetchBTCData();
setInterval(fetchBTCData, 60000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RACETRACK TICKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const quotes = [
    { text: 'Meow Go Vroom',                              cat: true  },
    { text: 'Morrocats',                                  cat: false },
    { text: '2028',                                       cat: false },
    { text: 'Motocats in the Lead',                       cat: true  },
    { text: 'GMoto',                                      cat: false },
    { text: 'mm',                                         cat: false },
    { text: 'Motocats Are Key',                           cat: true  },
    { text: "They call us the Motocats â€” engines purrin' digital flame", cat: true },
  ];

  // Colour cycling for variety
  const colours = [
    'var(--text)',
    'var(--orange)',
    'var(--gold)',
    'var(--purple-l)',
    'var(--text)',
    'var(--gold)',
    'var(--orange)',
    'var(--purple-l)',
  ];

  function buildItems() {
    return quotes.map((q, i) => `
      <span class="race-item" style="color:${colours[i % colours.length]}">
        ${q.cat ? '<span class="race-cat">ğŸğŸ±</span>' : ''}
        ${q.text}
      </span>
      <span class="race-sep">â—†</span>
    `).join('');
  }

  const track = document.getElementById('raceTrack');
  if (!track) return;
  // Duplicate content for seamless infinite scroll
  const content = buildItems();
  track.innerHTML = content + content;
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RIPPLE ENGINE (consistent with ecosystem)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  const canvas = document.getElementById('rippleCanvas');
  const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
  if (!gl) return;

  const VS = `attribute vec2 a_pos;void main(){gl_Position=vec4(a_pos,0.0,1.0);}`;
  const FS = `
    precision highp float;
    uniform vec2 u_res;uniform float u_time;uniform vec3 u_drops[12];
    float ripple(vec2 uv,vec2 center,float born){
      float age=u_time-born;float dist=length(uv-center);
      float wave=sin(dist*18.0-age*4.5)*exp(-dist*2.2)*exp(-age*0.5);
      float mask=smoothstep(age*280.0,0.0,dist);return wave*mask*0.5;
    }
    void main(){
      vec2 uv=gl_FragCoord.xy/u_res;vec2 aspect=vec2(u_res.x/u_res.y,1.0);
      vec2 uvA=uv*aspect;float h=0.0;
      for(int i=0;i<12;i++){if(u_drops[i].z<0.0)continue;
        vec2 c=(u_drops[i].xy/u_res)*aspect;h+=ripple(uvA,c,u_drops[i].z);}
      float swirl=sin(uv.x*3.1+u_time*0.18)*0.5+cos(uv.y*2.7-u_time*0.13)*0.5;
      h+=swirl*0.04;
      vec3 deep=vec3(0.027,0.016,0.075);vec3 mid=vec3(0.12,0.05,0.32);
      vec3 bright=vec3(0.45,0.18,0.85);vec3 sheen=vec3(0.78,0.42,1.00);
      float t=clamp(h+0.5,0.0,1.0);
      vec3 col=mix(deep,mid,smoothstep(0.0,0.45,t));
      col=mix(col,bright,smoothstep(0.45,0.7,t));
      col=mix(col,sheen,smoothstep(0.7,1.0,t)*0.6);
      float fromCentre=1.0-length((uv-vec2(0.5,0.6))*vec2(1.0,0.7));
      col+=vec3(0.18,0.05,0.0)*pow(clamp(fromCentre,0.0,1.0),3.0)*0.4;
      gl_FragColor=vec4(col,1.0);
    }`;

  function compile(type, src) {
    const s = gl.createShader(type); gl.shaderSource(s, src); gl.compileShader(s); return s;
  }
  const prog = gl.createProgram();
  gl.attachShader(prog, compile(gl.VERTEX_SHADER, VS));
  gl.attachShader(prog, compile(gl.FRAGMENT_SHADER, FS));
  gl.linkProgram(prog); gl.useProgram(prog);
  const buf = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER, buf);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1,1,-1,-1,1,1,1]), gl.STATIC_DRAW);
  const loc = gl.getAttribLocation(prog, 'a_pos');
  gl.enableVertexAttribArray(loc); gl.vertexAttribPointer(loc, 2, gl.FLOAT, false, 0, 0);
  const uRes = gl.getUniformLocation(prog, 'u_res');
  const uTime = gl.getUniformLocation(prog, 'u_time');
  const uDrops = gl.getUniformLocation(prog, 'u_drops[0]');

  const drops = Array.from({length:12}, () => [0, 0, -99]);
  let idx = 0;
  function spawn(x, y) { drops[idx++ % 12] = [x, y, performance.now() / 1000]; }

  function ambient() {
    setTimeout(() => { spawn(Math.random()*canvas.width, Math.random()*canvas.height); ambient(); },
    4000 + Math.random() * 3000);
  }
  ambient();

  window.addEventListener('click', e => spawn(e.clientX, e.clientY));
  window.addEventListener('touchstart', e => { const t=e.touches[0]; spawn(t.clientX, t.clientY); }, {passive:true});

  function resize() { canvas.width=window.innerWidth; canvas.height=window.innerHeight; gl.viewport(0,0,canvas.width,canvas.height); }
  resize(); window.addEventListener('resize', resize);

  function render() {
    const t = performance.now() / 1000;
    gl.uniform2f(uRes, canvas.width, canvas.height); gl.uniform1f(uTime, t);
    gl.uniform3fv(uDrops, new Float32Array(drops.flat()));
    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4); requestAnimationFrame(render);
  }
  render();

  setTimeout(() => spawn(canvas.width*.3, canvas.height*.4), 200);
  setTimeout(() => spawn(canvas.width*.7, canvas.height*.6), 800);
  setTimeout(() => spawn(canvas.width*.5, canvas.height*.25), 1400);
})();
</script>
</body>
</html>
